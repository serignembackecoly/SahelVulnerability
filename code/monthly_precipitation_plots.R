# Monthly precipitation in Burkina Faso

# Librairies
library(multipanelfigure)
# data

max_pr <- round(max(df$mean),2)
# Visualisation
df_soud <- data.frame(cbind(month.abb,mean = soudanian_mean)) %>% 
  mutate(m = as.numeric(mean),
         month = factor(month.abb,
                        levels = month.abb))
max_pr_soud <- round(max(df_soud$m),2)

df_sahel <- data.frame(cbind(month.abb,mean = sahelian_mean)) %>% 
  mutate(m = as.numeric(mean),
         month = factor(month.abb,
                        levels = month.abb))
max_pr_sahel <- round(max(df_sahel$m),2)

df_sahelo_soud <- data.frame(cbind(month.abb,mean = sahelo_soudanian_mean)) %>% 
  mutate(m = as.numeric(mean),
         month = factor(month.abb,
                        levels = month.abb))
max_pr_sahelo_soud <- round(max(df_sahelo_soud$m),2)

max_pr_bfa <- round(max(df$mean),2)


p1 <- df_soud %>% 
  ggplot(aes(x = month)) +
  geom_line(aes(y = m, group = 1),
            linewidth = 1) +
  geom_point(aes(y = m), color = "navy") +
  geom_point(aes(x = 8, y = max_pr_soud),
             size = 3, color = "red") +
  geom_label(aes(x = 7.4, y = max_pr_soud - 2,
                 label = max_pr_soud),
             color = "red")+
  labs(y = "Precipitation [mm]",
       x = NULL) +
  scale_y_continuous(expand = c(0.01,3)) +
  scale_x_discrete(expand = c(0,0.2),
                   label = substr(month.abb, 1, 1)) +
  theme_classic() +
  theme(
    axis.text = element_text(face = "bold", size = 12),
    axis.title = element_text(face = "bold", size = 12)
  )

p2 <- df_sahel %>% 
  ggplot(aes(x = month)) +
  geom_line(aes(y = m, group = 1),
            linewidth = 1) +
  geom_point(aes(y = m), color = "navy") +
  geom_point(aes(x = 8, y = max_pr_sahel),
             size = 3, color = "red") +
  geom_label(aes(x = 7.4, y = max_pr_sahel - 2,
                 label = max_pr_sahel),
             color = "red")+
  labs(y = "Precipitation [mm]",
       x = NULL) +
  scale_y_continuous(expand = c(0.01,3)) +
  scale_x_discrete(expand = c(0,0.2),
                   label = substr(month.abb, 1, 1)) +
  theme_classic() +
  theme(
    axis.text = element_text(face = "bold", size = 12),
    axis.title = element_text(face = "bold", size = 12)
  )

p3 <- df_sahelo_soud %>% 
  ggplot(aes(x = month)) +
  geom_line(aes(y = m, group = 1),
            linewidth = 1) +
  geom_point(aes(y = m), color = "navy") +
  geom_point(aes(x = 8, y = max_pr_sahelo_soud),
             size = 3, color = "red") +
  geom_label(aes(x = 7.4, y = max_pr_sahelo_soud - 2,
                 label = max_pr_sahelo_soud),
             color = "red")+
  labs(y = "Precipitation [mm]",
       x = NULL) +
  scale_y_continuous(expand = c(0.01,3)) +
  scale_x_discrete(expand = c(0,0.2),
                   label = substr(month.abb, 1, 1)) +
  theme_classic() +
  theme(
    axis.text = element_text(face = "bold", size = 12),
    axis.title = element_text(face = "bold", size = 12)
  )

p4 <- df %>% 
  ggplot(aes(x = month.abb)) +
  geom_line(aes(y = mean, group = 1),
            linewidth = 1) +
  geom_point(aes(y = mean), color = "navy") +
  geom_point(aes(x = 8, y = max_pr_bfa),
             size = 3, color = "red") +
  geom_label(aes(x = 7.4, y = max_pr_bfa - 2,
                 label = max_pr_bfa),
             color = "red")+
  labs(y = "Precipitation [mm]",
       x = NULL) +
  scale_y_continuous(expand = c(0.01,3)) +
  scale_x_discrete(expand = c(0,0.2),
                   label = substr(month.abb, 1, 1)) +
  theme_classic() +
  theme(
    axis.text = element_text(face = "bold", size = 12),
    axis.title = element_text(face = "bold", size = 12)
  )
ggsave("figures/monthly_precip_plot_sahelo_soudanian.png", height = 5,
       width = 7, dpi = 600)
plots <- list()
plots[[1]] <- p1
plots[[2]] <- p2
plots[[3]] <- p3
plots[[4]] <- p4
plots[[5]] <- p5

figure <- multi_panel_figure(columns = 8, rows = 4, panel_label_type = "none")
figure %<>%
  fill_panel(plots[[1]], column = 1:2, row = 1, height = 5, width =7) %<>%
  fill_panel(plots[[2]], column = 7:8, row = 1) %<>%
  fill_panel(plots[[5]], column = 2:6, row = 2:3) %<>%
  fill_panel(plots[[3]], column = 1:2, row = 4) %<>%
  fill_panel(plots[[4]], column = 7:8, row = 4)
figure

