# Transform Netcdf files to csv to easily share them in the GitHub repository

# Librairies

library(tidyverse)
library(ncdf4)
library(lubridate)
library(data.table)

# Load the CHIRPS Data
nc_fname <- "E:/Chirps_daily/chirps_1981_2014/chirps-v2.0.1981.days_p05.nc"
nc_precip <- nc_open(nc_fname)

# Extract the coordinates
dim_lon <- ncvar_get(nc_precip, "longitude")
dim_lat <- ncvar_get(nc_precip, "latitude")
dim_time <- ncvar_get(nc_precip, "time")

# Extract variable
var1 <- ncvar_get(nc_precip, "precip", collapse_degen=FALSE) # Failed for now


# Time conversion
t_units <- ncatt_get(nc_precip, "time", "units")
t_ustr <- strsplit(t_units$value, " ")
t_dstr <- strsplit(unlist(t_ustr)[3], "-")
date <- ymd(t_dstr) + ddays(dim_time)
date
