# Calcul of indices in R

# Load data

chirps_81 <- stack(list.files("E:/Chirps_daily/BFA/", pattern = ".nc$",
                             full.names = T))  # "E:/Chirps_daily/BFA/chirps_BFA_1981.nc"

plot(chirps_81)

bfa_shp <- readOGR(paste0("data/Burkina/BFA_adm1.shp"), verbose=F)
provinces <- bfa_shp$NAME_1
extracted <- round(exact_extract(chirps_81, bfa_shp, fun = "mean"),2)
rm(chirps_81)
yr_81 <- cbind(provinces = provinces, extracted)

bfa_pr_81 <- pivot_longer(yr_81, cols = 2:length(yr_81), names_to = "jour", values_to = "precipitation") %>% 
  mutate(date = rep(seq(ymd("1981-01-01"), ymd("1981-12-31"), by = "day"), 44)) %>% 
  select(provinces, date, precipitation)

df <- bfa_pr_81 %>% pivot_wider(names_from = provinces, values_from = precipitation)
